---
title: "保证金交易风险管理（三）标记价格"
date: 2025-05-07T16:38:19+08:00
series: ["Derivatives Trading"]
draft: false
---

终于，在理解了 [__指数价格__](/posts/derivatives-002) 和 [__资金费率__]/posts/derivatives-003) 之后，可以来算标记价格了。[以Binance为例](https://www.binance.com/zh-CN/support/faq/detail/360033525071)，对于u本位的永续合约，标记价格公式如下：

$$
标记价格 = Median(价格 1, 价格 2, 合约价格)
$$

$$
价格 1 = 指数价格 * (1 + 最新资金费率 * (距下一次资金费率收取的时间 / 资金费率收取周期))
$$

$$
价格 2 = 指数价格 + 移动平均值(2.5 分钟基差)
$$

- 移动平均值(2.5 分钟基差)为 2.5 分钟内 30 个数据点的平均值。数据点每 5 秒计算一次，计算方法为取买价和卖价的平均值，然后减去价格指数。

- 作为对照，[Bybit](https://www.bybit.com/zh-MY/help-center/article/Mark-Price-Calculation-Perpetual-Contracts)使用的是5 分钟移动平均值，且每秒计算一次

- 在极端市场情况下，Binance的做法是使用价格 2，Bybit的做法是使用最新成交价

为什么需要标记价格？在极端市场情况下，合约的最新成交价格可能因为短暂的买卖失衡与现货价格产生较大偏差，所以不适合用来计算盈亏和保证金率，从而判断是否触发平仓或者减仓。

由标记价格和最新成交价构成的双套价格机制能起到什么作用呢？以下是Gemini 2.5 Pro的表演：

- 确保交易的高效与即时性（由最新成交价实现）：

    - 最新成交价是市场上买卖双方实际匹配并成交的价格。它是最真实反映当前市场供需关系和流动性的价格。

    - 所有用户的委托下单、撮合交易、最终成交都是基于这个市场上的实时最新成交价或委托深度价格。

    - 没有最新成交价，就无法进行实际的交易。它保证了交易行为能够高效、及时地完成，反映了市场在特定时间点的真实交易意愿。

- 防止不公平的强制平仓（由标记价格实现）：

    - 标记价格是一个更稳定、更难被操纵的价格，它通常是根据全球多家主要交易所的现货价格指数（或结合永续合约自身的成交数据）计算得出的。

    - 如果交易所仅仅根据波动剧烈且容易受短期大额订单、甚至潜在操纵影响的最新成交价来判断是否触发强制平仓，那么用户可能会因为瞬间的“插针”（价格短暂极端偏离）而被不公平地爆仓，即使资产的真实价值并没有跌到那么低（或涨到那么高）。

    - __标记价格作为强制平仓的判定标准，提供了一个更可靠、更接近底层资产“公允价值”的参照。__ 交易所使用标记价格来计算用户的未实现盈亏和保证金率，当标记价格触及用户的强平价格时，才会触发强制平仓流程。这极大地提高了清算的公平性，保护了用户免受短期异常波动的伤害。

- 更准确地计算未实现盈亏和保证金率（由标记价格实现）：

    - 用户的未实现盈亏（浮动盈亏）是根据其开仓均价和当前的标记价格来计算的。

    - 使用标记价格计算未实现盈亏，可以更真实地反映用户持仓基于资产“公允价值”的盈亏状况，而不是基于可能存在偏差的最新成交价。

    - 未实现盈亏直接影响用户的保证金率（可用保证金/占用保证金）。保证金率是衡量账户风险水平的关键指标。使用标记价格计算保证金率，使得风险评估更加稳健和准确，为用户和平台提供了更可靠的风险监控。

- 提高市场的抗操纵性：

    - 通过将敏感的风险管理（如清算）与实时交易价格分离，双套价格机制使得单个交易所或短期的大额交易更难通过操纵最新成交价来恶意触发其他用户的强制平仓。即使市场价格被瞬间拉高或砸低，只要标记价格没有达到强平线，用户的仓位就不会被强制平仓。

以上。